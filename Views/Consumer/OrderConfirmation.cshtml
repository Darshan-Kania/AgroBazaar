@model AgroBazaar.Models.Entities.Order

@{
    ViewData["Title"] = "Order Confirmation - AgroBazaar";
}

<div class="row">
    <div class="col-12 text-center">
        <div class="mb-4">
            <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
            <h1 class="text-success mt-3">Order Placed Successfully!</h1>
            <p class="lead text-muted">Thank you for your order. We'll get your fresh products ready for delivery.</p>
        </div>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-receipt"></i> Order Details</h5>
            </div>
            <div class="card-body">
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h6>Order Information</h6>
                        <p class="mb-1"><strong>Order Number:</strong> @Model.OrderNumber</p>
                        <p class="mb-1"><strong>Order Date:</strong> @Model.OrderDate.ToString("dd MMM yyyy, hh:mm tt")</p>
                        <p class="mb-1"><strong>Status:</strong> <span class="badge bg-warning">@Model.Status</span></p>
                        <p class="mb-1"><strong>Payment Method:</strong> @Model.PaymentMethod</p>
                    </div>
                    <div class="col-md-6">
                        <h6>Delivery Information</h6>
                        <p class="mb-1"><strong>Delivery Address:</strong></p>
                        <p class="text-muted">@Model.DeliveryAddress</p>
                        <p class="mb-1"><strong>Estimated Delivery:</strong> 2-3 business days</p>
                    </div>
                </div>

                <h6>Order Items</h6>
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead class="table-light">
                            <tr>
                                <th>Product</th>
                                <th>Farmer</th>
                                <th>Price</th>
                                <th>Quantity</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.OrderItems)
                            {
                                <tr>
                                    <td>
                                        <strong>@item.Product.Name</strong><br>
                                        <small class="text-muted">@item.Product.Category.Name</small>
                                    </td>
                                    <td>@item.Product.Farmer.FirstName @item.Product.Farmer.LastName</td>
                                    <td>₹@item.UnitPrice.ToString("N2")</td>
                                    <td>@item.Quantity @item.Product.Unit</td>
                                    <td><strong>₹@item.TotalPrice.ToString("N2")</strong></td>
                                </tr>
                            }
                        </tbody>
                        <tfoot class="table-light">
                            <tr>
                                <th colspan="4" class="text-end">Total Amount:</th>
                                <th class="text-success">₹@Model.TotalAmount.ToString("N2")</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="alert alert-info">
                            <h6><i class="fas fa-info-circle"></i> What's Next?</h6>
                            <ul class="mb-0">
                                <li>We'll prepare your order within 24 hours</li>
                                <li>You'll receive SMS updates on order status</li>
                                <li>Track your order anytime from your dashboard</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="alert alert-success">
                            <h6><i class="fas fa-shield-alt"></i> Quality Promise</h6>
                            <ul class="mb-0">
                                <li>Fresh products directly from farms</li>
                                <li>Quality checked before delivery</li>
                                <li>100% satisfaction guarantee</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="d-flex gap-3 justify-content-center mt-4">
                    <a asp-action="Orders" class="btn btn-outline-primary">
                        <i class="fas fa-list"></i> View All Orders
                    </a>
                    <a asp-action="Products" class="btn btn-success">
                        <i class="fas fa-shopping-bag"></i> Continue Shopping
                    </a>
                    <button class="btn btn-outline-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print Order
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Auto-redirect to dashboard after 30 seconds
        setTimeout(function() {
            if (confirm('Would you like to go to your dashboard to track this order?')) {
                window.location.href = '@Url.Action("Dashboard", "Consumer")';
            }
        }, 30000);

        // Print styles for better formatting
        window.addEventListener('beforeprint', function() {
            document.title = 'Order Confirmation - @Model.OrderNumber';
        });
    </script>
}

<style media="print">
    .btn, .alert {
        display: none !important;
    }
    
    .card {
        border: none !important;
        box-shadow: none !important;
    }
</style>
